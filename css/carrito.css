        /* Variables CSS (copiadas de main.css) */
        :root {
            --dark-primary: #1a202c; /* Carbón muy oscuro */
            --light-bg: #f7fafc;    /* Gris muy claro, casi blanco */
            --accent-bold: #e53e3e; /* Rojo oscuro o borgoña, fuerte */
            --text-main: #2d3748;   /* Gris oscuro para el texto */
            --text-light: #ffffff;  /* Blanco puro */
            --border-strong: #a0aec0; /* Gris medio para bordes */
            --subtle-blue: #4a5568; /* Azul grisáceo para detalles */
            --step-active: var(--accent-bold);
            --step-inactive: #e2e8f0; /* Gris muy claro para pasos inactivos */
            --step-completed: var(--dark-primary);
            --shadow-light: 0 4px 15px rgba(0,0,0,0.08);
            --shadow-medium: 0 8px 25px rgba(0,0,0,0.15);
            --shadow-hover: 0 8px 20px rgba(0,0,0,0.1); /* Nueva sombra para hover */
        }

        /* Reset básico y estilos generales */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            line-height: 1.6;
            color: var(--text-main);
            background-color: var(--light-bg);
            scroll-behavior: smooth;
        }

        a {
            text-decoration: none;
            color: var(--accent-bold);
            transition: color 0.3s ease;
        }

        a:hover {
            color: var(--dark-primary);
        }

        .btn {
            display: inline-block;
            padding: 14px 30px;
            border-radius: 8px;
            font-size: 1.05rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: var(--shadow-light);
            border: none;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .btn:before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 300%;
            height: 300%;
            background-color: rgba(255,255,255,0.15);
            border-radius: 50%;
            transition: all 0.4s ease-in-out;
            transform: translate(-50%, -50%) scale(0);
            opacity: 0;
            z-index: 0;
        }

        .btn:hover:before {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-bold) 0%, #c53030 100%);
            color: var(--text-light);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #c53030 0%, var(--accent-bold) 100%);
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }

        .btn-secondary {
            background-color: transparent;
            color: var(--dark-primary);
            border: 2px solid var(--dark-primary);
            box-shadow: none;
        }

        .btn-secondary:hover {
            background-color: var(--dark-primary);
            color: var(--text-light);
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }

        /* Header específico para carrito */
        .cart-header {
            background-color: var(--text-light);
            border-bottom: 1px solid var(--border-strong);
            padding: 1.5rem 0;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .cart-header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-header-content .logo {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.2rem;
            font-weight: 800;
            color: var(--dark-primary);
            letter-spacing: 0.08em;
            text-transform: uppercase;
            transition: color 0.3s ease;
        }
        .cart-header-content .logo:hover {
            color: var(--accent-bold);
        }

        .back-to-store {
            color: var(--subtle-blue);
            font-size: 1.05rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: color 0.3s ease;
        }

        .back-to-store:hover {
            color: var(--accent-bold);
        }

        /* Contenedor principal del carrito/checkout */
        .checkout-main-container {
            max-width: 1200px;
            margin: 50px auto;
            padding: 30px;
            background-color: var(--text-light);
            border-radius: 12px;
            box-shadow: var(--shadow-medium);
            
            display: grid;
            grid-template-columns: 1fr;
            gap: 40px;
        }

        /* Barra de progreso de pasos */
        .progress-bar {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin-bottom: 50px;
            position: relative;
            padding: 25px 0;
            grid-column: 1 / -1;
        }

        .progress-bar::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 10%;
            right: 10%;
            height: 5px;
            background-color: var(--step-inactive);
            transform: translateY(-50%);
            z-index: 0;
            border-radius: 5px;
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 1;
            flex: 1;
            text-align: center;
        }

        .progress-step-icon {
            width: 55px;
            height: 55px;
            border-radius: 50%;
            background-color: var(--step-inactive);
            color: var(--text-light);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.6rem;
            margin-bottom: 12px;
            transition: background-color 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 3px 8px rgba(0,0,0,0.2);
        }

        .progress-step-text {
            font-size: 0.95rem;
            font-weight: 700;
            color: var(--subtle-blue);
            transition: color 0.3s ease;
        }

        .progress-step.active .progress-step-icon {
            background-color: var(--step-active);
            transform: scale(1.15);
            box-shadow: 0 5px 15px rgba(229, 62, 62, 0.4);
        }

        .progress-step.active .progress-step-text {
            color: var(--step-active);
        }

        .progress-step.completed .progress-step-icon {
            background-color: var(--step-completed);
            color: var(--text-light);
            box-shadow: 0 3px 8px rgba(26, 32, 44, 0.4);
        }

        .progress-step.completed .progress-step-text {
            color: var(--step-completed);
        }

        /* Contenido de los pasos */
        .checkout-step-content {
            display: none;
            padding: 30px 0;
            border-top: 1px solid var(--border-strong);
            margin-top: 20px;
            grid-column: 1 / -1;
        }

        .checkout-step-content.active {
            display: block;
        }

        /* Estilos del carrito de compras (Paso 0) */
        .cart-summary-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 50px;
        }

        .cart-items-list {
            border: 1px solid var(--border-strong);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--shadow-light);
        }

        .cart-item {
            display: flex;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid var(--border-strong);
            background-color: var(--text-light);
            transition: background-color 0.2s ease;
        }

        .cart-item:hover {
            background-color: #f0f4f8;
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .cart-item-image {
            width: 90px;
            height: 90px;
            object-fit: cover;
            border-radius: 8px;
            margin-right: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .cart-item-details {
            flex-grow: 1;
        }

        .cart-item-details h4 {
            font-size: 1.2rem;
            margin-bottom: 8px;
            color: var(--dark-primary);
            font-weight: 700;
        }

        .cart-item-details p {
            font-size: 0.95rem;
            color: var(--subtle-blue);
        }

        .cart-item-quantity-control {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 0 20px;
        }

        .cart-item-quantity-control button {
            background-color: var(--light-bg);
            border: 1px solid var(--border-strong);
            border-radius: 50%;
            width: 35px;
            height: 35px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.2s ease;
            color: var(--text-main);
        }

        .cart-item-quantity-control button:hover {
            background-color: var(--accent-bold);
            color: var(--text-light);
            transform: scale(1.05);
            border-color: var(--accent-bold);
        }

        .cart-item-quantity-control input {
            width: 50px;
            text-align: center;
            border: 1px solid var(--border-strong);
            border-radius: 5px;
            padding: 8px 0;
            font-size: 1rem;
            color: var(--dark-primary);
            font-weight: 600;
        }

        .cart-item-price {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--dark-primary);
            width: 120px;
            text-align: right;
            flex-shrink: 0;
        }

        .cart-item .remove-item-btn {
            background: none;
            border: none;
            color: var(--accent-bold);
            font-size: 1rem;
            cursor: pointer;
            margin-left: 20px;
            transition: color 0.2s ease, transform 0.2s ease;
        }

        .cart-item .remove-item-btn:hover {
            color: var(--dark-primary);
            transform: scale(1.1);
        }

        .cart-summary {
            background-color: var(--light-bg);
            padding: 30px;
            border-radius: 10px;
            box-shadow: var(--shadow-light);
            display: flex;
            flex-direction: column;
            gap: 20px;
            height: fit-content;
        }

        .cart-summary h3 {
            font-size: 1.8rem;
            color: var(--dark-primary);
            margin-bottom: 20px;
            text-align: center;
            font-weight: 800;
        }

        .cart-summary-row {
            display: flex;
            justify-content: space-between;
            font-size: 1.15rem;
            padding-bottom: 12px;
            border-bottom: 1px dashed var(--border-strong);
        }

        .cart-summary-row:last-of-type {
            border-bottom: none;
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--accent-bold);
            margin-top: 15px;
        }

        .cart-summary-row span:first-child {
            color: var(--text-main);
            font-weight: 600;
        }

        .cart-actions {
            margin-top: 30px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .cart-actions .btn {
            width: 100%;
        }

        /* Paso 1: Datos Personales */
        .step-personal-data, .step-shipping, .step-payment {
            padding: 20px;
        }

        .step-personal-data h2, .step-shipping h2, .step-payment h2 {
            text-align: center;
            font-size: 2.2rem;
            margin-bottom: 30px;
            color: var(--dark-primary);
            font-weight: 800;
        }

        .step-personal-data .email-input-section {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            border: 1px solid var(--border-strong);
            border-radius: 12px;
            background-color: var(--text-light);
            box-shadow: var(--shadow-light);
        }
        .step-personal-data .email-input-section p {
            margin-bottom: 25px;
            font-size: 1.15rem;
            color: var(--text-main);
            font-weight: 500;
        }
        .step-personal-data .email-input-section .input-button-group {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 15px;
        }
        .step-personal-data .email-input-section input {
            flex-grow: 1;
            min-width: 250px;
            max-width: 400px;
            padding: 16px 20px;
            border: 2px solid var(--border-strong);
            border-radius: 8px;
            font-size: 1.1rem;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        .step-personal-data .email-input-section input:focus {
            outline: none;
            border-color: var(--accent-bold);
            box-shadow: 0 0 0 3px rgba(229, 62, 62, 0.2);
        }
        .step-personal-data .email-input-section .btn {
            padding: 16px 35px;
            font-size: 1.1rem;
            flex-shrink: 0;
        }
        /* Eliminada la sección de lista de beneficios */

        /* Formulario de Datos Personales */
        .personal-data-form-full {
            display: none; /* Hidden by default, shown by JS */
            max-width: 550px; /* Ancho ajustado para una sola columna */
            margin: 0 auto;
            display: flex; /* Usar flexbox para apilar elementos */
            flex-direction: column;
            gap: 20px; /* Espacio entre los grupos de formulario */
            padding: 30px;
            border: 1px solid var(--border-strong);
            border-radius: 10px;
            background-color: var(--text-light);
            box-shadow: var(--shadow-light);
        }

        .personal-data-form-full .form-group {
            margin-bottom: 0; /* Eliminado margen inferior ya que el gap de flexbox lo maneja */
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 700;
            color: var(--text-main);
            font-size: 0.95rem;
        }
        .personal-data-form-full input[type="text"],
        .personal-data-form-full input[type="email"],
        .personal-data-form-full input[type="tel"],
        .personal-data-form-full select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-strong);
            border-radius: 6px;
            font-size: 1rem;
            color: var(--text-main);
            background-color: var(--light-bg);
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        .personal-data-form-full input:focus,
        .personal-data-form-full select:focus {
            outline: none;
            border-color: var(--accent-bold);
            box-shadow: 0 0 0 3px rgba(229, 62, 62, 0.2);
        }
        .personal-data-form-full select {
            appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%232d3748%22%20d%3D%22M287%2C197.3L159.2%2C69.5c-4.7-4.7-12.3-4.7-17%2C0L5.4%2C197.3c-4.7%2C4.7-4.7%2C12.3%2C0%2C17l8.5%2C8.5c4.7%2C4.7%2C12.3%2C4.7%2C17%2C0l118.8-118.8l118.8%2C118.8c4.7%2C4.7%2C12.3%2C4.7%2C17%2C0l8.5-8.5C291.7%2C209.6%2C291.7%2C202%2C287%2C197.3z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 12px center; /* Ajustado posición */
            background-size: 12px; /* Ajustado tamaño */
            padding-right: 30px; /* Ajustado padding */
        }

        /* Checkbox para "Deseo factura" */
        .invoice-checkbox-group {
            margin-top: 10px; /* Espacio entre el último input y este checkbox */
        }
        .invoice-checkbox-group label {
            display: flex;
            align-items: center;
            font-size: 0.95rem;
            color: var(--text-main);
            font-weight: 400;
        }
        .invoice-checkbox-group input[type="checkbox"] {
            margin-right: 10px;
            width: 18px;
            height: 18px;
            accent-color: var(--accent-bold);
            flex-shrink: 0;
        }

        .terms-checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 25px;
            text-align: left;
        }
        .terms-checkbox-group label {
            display: flex;
            align-items: flex-start;
            font-size: 0.95rem;
            color: var(--text-main);
            font-weight: 400;
        }
        .terms-checkbox-group input[type="checkbox"] {
            margin-right: 10px;
            width: 18px;
            height: 18px;
            accent-color: var(--accent-bold);
            flex-shrink: 0;
            margin-top: 2px;
        }
        .terms-checkbox-group a {
            color: var(--accent-bold);
            text-decoration: underline;
            font-weight: 600;
        }

        .step-personal-data .continue-btn-container {
            text-align: center;
            margin-top: 40px;
        }

        /* Paso 2: Envío */
        .step-shipping .shipping-options {
            display: flex;
            justify-content: center;
            /* Eliminado gap y flex-wrap aquí para controlarlo en .shipping-option-group */
            margin-bottom: 40px;
        }

        /* Nuevo contenedor para los botones de envío/recogida (pill shape) */
        .shipping-option-group {
            display: flex;
            border: 1px solid var(--border-strong);
            border-radius: 50px; /* Muy redondeado para la forma de píldora */
            overflow: hidden; /* Asegura que los bordes internos se recorten */
            background-color: var(--light-bg);
            box-shadow: var(--shadow-light);
            max-width: fit-content; /* Ajusta el ancho al contenido */
        }

        .shipping-option-btn {
            flex: 1; /* Distribuye el espacio equitativamente */
            padding: 12px 25px; /* Ajustado padding para la píldora */
            border: none; /* Eliminado el borde individual */
            background-color: transparent; /* Fondo transparente por defecto */
            color: var(--text-main);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center; /* Centrar contenido dentro del botón */
            gap: 10px;
            white-space: nowrap; /* Evita que el texto se rompa */
        }

        .shipping-option-btn.selected {
            background-color: #3182ce; /* Azul fuerte para seleccionado, como en la imagen */
            color: var(--text-light);
            box-shadow: none; /* Sombra manejada por el grupo */
            transform: none; /* Sin transformación individual */
        }
        /* Ajuste para el primer y último botón para mantener la forma de píldora */
        .shipping-option-btn:first-child {
            border-top-left-radius: 50px;
            border-bottom-left-radius: 50px;
        }
        .shipping-option-btn:last-child {
            border-top-right-radius: 50px;
            border-bottom-right-radius: 50px;
        }

        .shipping-option-btn:hover:not(.selected) {
            background-color: rgba(0,0,0,0.05); /* Fondo muy sutil al pasar el ratón */
            color: var(--dark-primary);
            transform: none; /* Sin elevación al pasar el ratón */
            box-shadow: none;
        }
        .shipping-option-btn i {
            font-size: 1.2rem; /* Icono ligeramente más pequeño para la píldora */
            color: var(--subtle-blue); /* Color inicial del icono */
            transition: color 0.3s ease;
        }
        .shipping-option-btn.selected i {
            color: var(--text-light); /* Icono blanco cuando seleccionado */
        }
        .shipping-option-btn:hover:not(.selected) i {
            color: var(--dark-primary); /* Icono oscuro al pasar el ratón */
        }


        /* Detalles de Envío/Recogida */
        .shipping-details-section {
            display: none;
            max-width: 550px; /* Ancho ajustado para una sola columna */
            margin: 0 auto 30px;
            padding: 30px;
            border: 1px solid var(--border-strong);
            border-radius: 10px;
            background-color: var(--light-bg);
            box-shadow: var(--shadow-light);
        }
        .shipping-details-section.active {
            display: block;
        }

        .shipping-details-section h3 {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: var(--dark-primary);
            text-align: center;
            font-weight: 800;
        }

        .shipping-details-section .form-group {
            margin-bottom: 20px;
        }
        .shipping-details-section input,
        .shipping-details-section select {
            width: 100%;
            padding: 14px 18px;
            border: 1px solid var(--border-strong);
            border-radius: 6px;
            font-size: 1rem;
            color: var(--text-main);
            background-color: var(--light-bg);
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        .shipping-details-section input:focus,
        .shipping-details-section select:focus {
            outline: none;
            border-color: var(--accent-bold);
            box-shadow: 0 0 0 3px rgba(229, 62, 62, 0.2);
        }
        .shipping-details-section select {
            appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%232d3748%22%20d%3D%22M287%2C197.3L159.2%2C69.5c-4.7-4.7-12.3-4.7-17%2C0L5.4%2C197.3c-4.7%2C4.7-4.7%2C12.3%2C0%2C17l8.5%2C8.5c4.7%2C4.7%2C12.3%2C4.7%2C17%2C0l118.8-118.8l118.8%2C118.8c4.7%2C4.7%2C12.3%2C4.7%2C17%2C0l8.5-8.5C291.7%2C209.6%2C291.7%2C202%2C287%2C197.3z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 14px;
            padding-right: 40px;
        }

        /* "Método de entrega" section for delivery */
        .delivery-method-option {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            border: 1px solid var(--border-strong);
            border-radius: 8px;
            background-color: var(--text-light);
            margin-bottom: 20px;
        }
        .delivery-method-option input[type="radio"] {
            margin-right: 10px;
            accent-color: var(--dark-primary);
            width: 18px;
            height: 18px;
        }
        .delivery-method-option label {
            font-weight: 600;
            color: var(--text-main);
            flex-grow: 1;
            margin-bottom: 0; /* Override default label margin */
        }
        .delivery-method-option span {
            font-weight: 700;
            color: #28a745; /* Green for "Gratis" */
        }

        /* Dirección de entrega actual (delivery) */
        .current-delivery-address {
            padding: 20px;
            border: 1px solid var(--border-strong);
            border-radius: 10px;
            background-color: var(--text-light);
            box-shadow: var(--shadow-light);
            margin-bottom: 25px;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        .current-delivery-address i {
            font-size: 1.8rem;
            color: var(--subtle-blue);
            flex-shrink: 0;
        }
        .current-delivery-address-text p {
            margin-bottom: 5px;
            font-size: 1rem;
            color: var(--text-main);
        }
        .current-delivery-address-text a {
            font-size: 0.9rem;
            font-weight: 600;
        }

        /* Pickup Details */
        .pickup-location-section {
            text-align: center;
            padding: 20px;
            border: 1px solid var(--border-strong);
            border-radius: 10px;
            background-color: var(--text-light);
            box-shadow: var(--shadow-light);
            margin-bottom: 25px;
        }
        .pickup-location-section h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: var(--dark-primary);
        }
        .pickup-location-section p {
            font-size: 1rem;
            color: var(--text-main);
            margin-bottom: 20px;
        }
        .pickup-location-section .map-icon {
            font-size: 4rem; /* Icono de mapa grande */
            color: #3182ce; /* Azul para el icono de mapa */
            margin-bottom: 25px;
        }
        .pickup-location-section .btn {
            width: 80%;
            max-width: 300px;
            margin-bottom: 15px;
        }
        .pickup-location-section .manual-search-link {
            display: block;
            font-size: 0.95rem;
            font-weight: 600;
            margin-top: 10px;
        }


        .step-shipping .continue-btn-container {
            text-align: center;
            margin-top: 40px;
        }

        /* Paso 3: Pago */
        .step-payment .payment-methods {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }
        .step-payment .payment-method-btn {
            padding: 18px 30px;
            border: 2px solid var(--border-strong);
            border-radius: 10px;
            background-color: var(--light-bg);
            color: var(--text-main);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: var(--shadow-light);
        }
        .step-payment .payment-method-btn.selected {
            background-color: var(--dark-primary);
            color: var(--text-light);
            border-color: var(--dark-primary);
            box-shadow: var(--shadow-medium);
            transform: translateY(-3px);
        }
        .step-payment .payment-method-btn:hover:not(.selected) {
            border-color: var(--accent-bold);
            color: var(--accent-bold);
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.1);
        }
        .payment-method-btn img {
            height: 28px;
            width: auto;
        }

        .payment-form-section {
            display: none;
            max-width: 550px;
            margin: 0 auto;
            padding: 30px;
            border: 1px solid var(--border-strong);
            border-radius: 10px;
            background-color: var(--light-bg);
            box-shadow: var(--shadow-light);
        }
        .payment-form-section.active {
            display: block;
        }
        .payment-form-section .form-group {
            margin-bottom: 20px;
        }
        .payment-form-section input {
            width: 100%;
            padding: 14px 18px;
            border: 1px solid var(--border-strong);
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        .payment-form-section input:focus {
            outline: none;
            border-color: var(--accent-bold);
            box-shadow: 0 0 0 3px rgba(229, 62, 62, 0.2);
        }
        .payment-form-section .card-icons {
            display: flex;
            gap: 12px;
            margin-top: 10px;
        }
        .payment-form-section .card-icons img {
            height: 30px;
            width: auto;
            opacity: 0.8;
        }
        .payment-form-section .expiry-cvv-group {
            display: flex;
            gap: 20px;
        }
        .payment-form-section .expiry-cvv-group .form-group {
            flex: 1;
        }
        .payment-form-section .expiry-cvv-group select {
             width: 100%;
            padding: 14px 18px;
            border: 1px solid var(--border-strong);
            border-radius: 6px;
            font-size: 1rem;
            appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%232d3748%22%20d%3D%22M287%2C197.3L159.2%2C69.5c-4.7-4.7-12.3-4.7-17%2C0L5.4%2C197.3c-4.7%2C4.7-4.7%2C12.3%2C0%2C17l8.5%2C8.5c4.7%2C4.7%2C12.3%2C4.7%2C17%2C0l118.8-118.8l118.8%2C118.8c4.7%2C4.7%2C12.3%2C4.7%2C17%2C0l8.5-8.5C291.7%2C209.6%2C291.7%2C202%2C287%2C197.3z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 14px;
            padding-right: 40px;
        }

        .step-payment .pay-now-btn {
            width: 100%;
            padding: 20px;
            font-size: 1.3rem;
            margin-top: 30px;
        }

        /* Resumen de la Compra (Sidebar en Checkout) */
        .checkout-summary-sidebar {
            background-color: var(--light-bg);
            padding: 30px;
            border-radius: 10px;
            box-shadow: var(--shadow-light);
            display: none;
            flex-direction: column;
            gap: 20px;
            height: fit-content;
        }
        .checkout-summary-sidebar h3 {
            font-size: 1.8rem;
            color: var(--dark-primary);
            margin-bottom: 20px;
            text-align: center;
            font-weight: 800;
        }
        .checkout-summary-sidebar .summary-products-list {
            max-height: 300px;
            overflow-y: auto;
            padding-right: 10px;
            margin-bottom: 15px;
        }
        .checkout-summary-sidebar .summary-product-item {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px dashed var(--border-strong);
        }
        .checkout-summary-sidebar .summary-product-item:last-of-type {
            border-bottom: none;
        }
        .checkout-summary-sidebar .summary-product-item img {
            width: 70px;
            height: 70px;
            object-fit: cover;
            border-radius: 6px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .checkout-summary-sidebar .summary-product-details {
            flex-grow: 1;
        }
        .checkout-summary-sidebar .summary-product-details h4 {
            font-size: 1.05rem;
            color: var(--dark-primary);
            margin-bottom: 5px;
            font-weight: 600;
        }
        .checkout-summary-sidebar .summary-product-details p {
            font-size: 0.9rem;
            color: var(--subtle-blue);
        }
        .checkout-summary-sidebar .summary-product-price {
            font-weight: 700;
            color: var(--dark-primary);
            font-size: 1.1rem;
        }
        .checkout-summary-sidebar .summary-total-row {
            display: flex;
            justify-content: space-between;
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--accent-bold);
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid var(--border-strong);
        }

        /* Mensaje de éxito */
        .purchase-success-message {
            display: none;
            text-align: center;
            padding: 60px;
            background-color: var(--light-bg);
            border-radius: 12px;
            box-shadow: var(--shadow-medium);
            max-width: 700px;
            margin: 60px auto;
            animation: fadeInScale 0.8s ease-out;
            grid-column: 1 / -1;
        }
        .purchase-success-message.active {
            display: block;
        }
        .purchase-success-message i {
            font-size: 5rem;
            color: #28a745;
            margin-bottom: 25px;
            animation: bounceIn 1s ease-out;
        }
        .purchase-success-message h2 {
            font-size: 2.8rem;
            color: var(--dark-primary);
            margin-bottom: 20px;
            font-weight: 800;
        }
        .purchase-success-message p {
            font-size: 1.3rem;
            color: var(--text-main);
            margin-bottom: 40px;
        }
        .purchase-success-message .btn {
            padding: 18px 45px;
            font-size: 1.2rem;
        }

        @keyframes bounceIn {
            0% { transform: scale(0.1); opacity: 0; }
            60% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(1); }
        }

        /* Custom Message Box (reutilizado de login.html) */
        .custom-message-box-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
            z-index: 3000;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }
        .custom-message-box-overlay.show {
            opacity: 1;
            display: flex;
        }
        .custom-message-box-content {
            background-color: var(--light-bg);
            padding: 35px;
            border-radius: 12px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
            text-align: center;
            max-width: 450px;
            width: 90%;
            transform: translateY(-20px);
            transition: transform 0.3s ease-out;
        }
        .custom-message-box-overlay.show .custom-message-box-content {
            transform: translateY(0);
        }
        .custom-message-box-content p {
            margin-bottom: 25px;
            font-size: 1.2rem;
            color: var(--text-main);
            font-weight: 600;
        }
        .custom-message-box-content .btn-primary {
            padding: 12px 30px;
            font-size: 1.05rem;
            margin-top: 15px;
        }

        /* Footer Styles (Copied and adapted from main.html for consistency) */
        .main-footer-robust {
            background-color: var(--dark-primary);
            color: var(--text-light);
            padding: 40px 20px;
            font-size: 0.9rem;
            text-align: center;
        }

        .footer-content-robust {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 30px;
        }

        .footer-section-robust {
            flex: 1;
            min-width: 250px;
            padding: 15px;
        }

        .footer-section-robust h3 {
            font-size: 1.4rem;
            margin-bottom: 20px;
            color: var(--accent-bold);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .footer-section-robust p {
            line-height: 1.8;
            color: #cbd5e0;
        }

        .footer-section-robust.links ul {
            list-style: none;
            padding: 0;
        }

        .footer-section-robust.links ul li {
            margin-bottom: 10px;
        }

        .footer-section-robust.links ul li a {
            color: var(--text-light);
            transition: color 0.3s ease;
        }

        .footer-section-robust.links ul li a:hover {
            color: var(--accent-bold);
        }

        .footer-section-robust.social a {
            display: inline-block;
            margin: 0 10px;
            transition: transform 0.3s ease;
        }

        .footer-section-robust.social a:hover {
            transform: translateY(-5px);
        }

        .footer-section-robust.social img {
            width: 35px;
            height: 35px;
            filter: invert(100%);
        }

        .footer-bottom-robust {
            border-top: 1px solid #4a5568;
            padding-top: 20px;
            margin-top: 20px;
            color: #a0aec0;
        }


        /* Media Queries */

        /* Para pantallas grandes (desktop) */
        @media (min-width: 993px) {
            .checkout-main-container.checkout-grid-layout {
                grid-template-columns: 2fr 1fr;
                gap: 50px;
            }

            #personalDataStep, #shippingStep, #paymentStep {
                grid-column: 1 / 2;
            }

            #checkoutSummarySidebar {
                display: flex;
                grid-column: 2 / 3;
            }
        }

        /* Para tabletas y pantallas medianas (hasta 992px) */
        @media (max-width: 992px) {
            .cart-summary-grid {
                grid-template-columns: 1fr;
            }
            .cart-summary {
                margin-top: 40px;
            }
            .personal-data-form-full { /* Adjusted for single column on smaller screens */
                flex-direction: column; /* Ensure it stacks on smaller screens */
                gap: 20px;
            }
            .step-personal-data .email-input-section .input-button-group {
                flex-direction: column;
                gap: 10px;
            }
            .step-personal-data .email-input-section input {
                width: 100%;
                margin-right: 0;
            }
            .step-personal-data .email-input-section .btn {
                width: 100%;
            }

            .checkout-main-container.checkout-grid-layout {
                grid-template-columns: 1fr;
            }
            #personalDataStep, #shippingStep, #paymentStep {
                grid-column: 1 / -1;
            }
            #checkoutSummarySidebar {
                grid-column: 1 / -1;
                order: 1;
                display: flex;
            }
            #cartStep .cart-summary {
                display: block;
            }
            .checkout-main-container.checkout-grid-layout #cartStep .cart-summary {
                display: none;
            }

            .footer-content-robust {
                flex-direction: column;
                align-items: center;
            }
            .footer-section-robust {
                min-width: unset;
                width: 100%;
                text-align: center;
            }
        }

        /* Para móviles (hasta 768px) */
        @media (max-width: 768px) {
            .cart-header-content {
                flex-direction: column;
                gap: 15px;
                padding: 0 15px;
            }
            .cart-header-content .logo {
                font-size: 1.8rem;
            }
            .back-to-store {
                font-size: 0.9rem;
            }
            .checkout-main-container {
                margin: 20px auto;
                padding: 15px;
            }
            .progress-bar {
                padding: 10px 0;
                margin-bottom: 20px;
            }
            .progress-step-icon {
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }
            .progress-step-text {
                font-size: 0.8rem;
            }
            .checkout-step-content {
                padding: 20px 0;
            }
            .step-personal-data h2, .step-shipping h2, .step-payment h2 {
                font-size: 1.8rem;
                margin-bottom: 20px;
            }
            .cart-item {
                flex-wrap: wrap;
                justify-content: center;
                text-align: center;
                padding: 15px;
            }
            .cart-item-image {
                margin-right: 0;
                margin-bottom: 10px;
                width: 70px;
                height: 70px;
            }
            .cart-item-details {
                text-align: center;
                width: 100%;
                margin-bottom: 10px;
            }
            .cart-item-quantity-control {
                margin: 0 auto 10px;
            }
            .cart-item-price {
                width: 100%;
                text-align: center;
                font-size: 1.2rem;
            }
            .cart-item .remove-item-btn {
                margin-left: 0;
                margin-top: 10px;
                font-size: 0.9rem;
            }
            .step-shipping .shipping-options {
                flex-direction: column;
            }
            .step-shipping .shipping-option-btn {
                width: 100%;
            }
            .payment-methods {
                flex-direction: column;
            }
            .payment-method-btn {
                width: 100%;
            }
            .step-personal-data .email-input-section input {
                margin-right: 0;
            }
        }

        /* Para móviles muy pequeños (hasta 480px) */
        @media (max-width: 480px) {
            .cart-header-content .logo {
                font-size: 1.5rem;
            }
            .progress-step-icon {
                width: 35px;
                height: 35px;
                font-size: 1rem;
            }
            .progress-step-text {
                font-size: 0.75rem;
            }
            .step-personal-data h2, .step-shipping h2, .step-payment h2 {
                font-size: 1.5rem;
            }
            .btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
            .cart-summary-grid {
                gap: 20px;
            }
            .cart-summary h3, .checkout-summary-sidebar h3 {
                font-size: 1.5rem;
            }
            .cart-summary-row, .checkout-summary-sidebar .summary-total-row {
                font-size: 1rem;
            }
            .purchase-success-message h2 {
                font-size: 2rem;
            }
            .purchase-success-message p {
                font-size: 1rem;
            }
        }